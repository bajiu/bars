require=function i(a,s,c){function u(r,t){if(!s[r]){if(!a[r]){var e="function"==typeof require&&require;if(!t&&e)return e(r,!0);if(m)return m(r,!0);var o=new Error("Cannot find module '"+r+"'");throw o.code="MODULE_NOT_FOUND",o}var n=s[r]={exports:{}};a[r][0].call(n.exports,function(t){return u(a[r][1][t]||t)},n,n.exports,i,a,s,c)}return s[r].exports}for(var m="function"==typeof require&&require,t=0;t<c.length;t++)u(c[t]);return u}({WaterWaveFrag:[function(t,r,e){"use strict";var o,n;cc._RF.push(r,"50ab0txu15BgqXYa82y/htD","WaterWaveFrag"),Object.defineProperty(e,"__esModule",{value:!0});var i=(n=o=function t(){(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")})(this,t)},o.waterwave_vert="\n    attribute vec4 a_position;\n    attribute vec2 a_texCoord;\n    attribute vec4 a_color;\n    varying vec2 v_texCoord;\n    varying vec4 v_fragmentColor;\n    void main()\n    {\n        gl_Position = CC_PMatrix * a_position;\n        v_fragmentColor = a_color;\n        v_texCoord = a_texCoord;\n    }\n    ",o.waterwave_frag="\n    #ifdef GL_ES\n    precision mediump float;\n    #endif\n    \n    #define F cos(x-y)*cos(y),sin(x+y)*sin(y)\n\n    uniform float time;\n    uniform vec2 resolution;\n    varying vec2 v_texCoord;\n\n    vec2 s(vec2 p)\n    {\n        float d=time*0.2,x=8.*(p.x+d),y=8.*(p.y+d);\n        return vec2(F);\n    }\n    void mainImage( out vec4 fragColor, in vec2 fragCoord )\n    {\n        // 换成resolution\n        vec2 rs = resolution.xy;\n        // 换成纹理坐标v_texCoord.xy\n        vec2 uv = v_texCoord.xy;\n        vec2 q = uv+2./resolution.x*(s(uv)-s(uv+rs));\n        //反转y\n        // q.y=1.-q.y;\n        fragColor = texture2D(CC_Texture0,q);\n    }\n    void main()\n    {\n        mainImage(gl_FragColor, gl_FragCoord.xy);\n    }\n    ",n);e.default=i,r.exports=e.default,cc._RF.pop()},{}],water:[function(t,r,e){"use strict";var o;cc._RF.push(r,"01a60/6zkJMELoJ5TSQfmih","water");var n,i=t("WaterWaveFrag"),a=(n=i)&&n.__esModule?n:{default:n};function s(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}cc.Class({extends:cc.Component,ctor:function(){this.resolution={x:0,y:0}},properties:(o={startTime:{type:Number,default:0}},s(o,"startTime",Date.now()),s(o,"time",0),o),statics:{resolution:{x:0,y:0}},onLoad:function(){console.log(this),console.log(cc.GLProgram),console.log(cc.sys),this.resolution.x=this.node.getContentSize().width,this.resolution.y=this.node.getContentSize().height,this.userWater()},userWater:function(){this.program=new cc.GLProgram,this.program.initWithVertexShaderByteArray(a.default.waterwave_vert,a.default.waterwave_frag),this.program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),this.program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),this.program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS),this.program.link(),this.program.updateUniforms(),this.program.use();var t=this.program.getUniformLocationForName("resolution"),r=this.program.getUniformLocationForName("time");this.program.setUniformLocationWith2f(t,this.resolution.x,this.resolution.y),this.program.setUniformLocationWith1f(r,this.time),this.setProgram(this.node.getComponent(cc.Sprite)._sgNode,this.program)},setProgram:function(t,r){t.setShaderProgram(r)},start:function(){},update:function(t){if(this.time=(Date.now()-this.startTime)/1e3,this.program){this.program.use();var r=this.program.getUniformLocationForName("time");this.program.setUniformLocationWith1f(r,this.time)}}}),cc._RF.pop()},{WaterWaveFrag:"WaterWaveFrag"}]},{},["WaterWaveFrag","water"]);